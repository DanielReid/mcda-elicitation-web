<div class="grid-x">
  <div class="cell">
    <a class="button small" ng-click="downloadWorkspace()">
      Download workspace
    </a>
  </div>
  <div class="cell">
    <h4>
      Therapeutic context
      <inline-help help-key="therapeutic-context"></inline-help>
      <a ng-if="editMode.isUserOwner && isStandAlone" ng-click="editTherapeuticContext()">
        <i class="fa fa-edit"></i>
      </a>
    </h4>
  </div>
  <div class="cell underlined-div">
    <span ng-if="problem.description">{{problem.description}}</span>
    <span ng-if="!problem.description">No description given.</span>
  </div>
  <div class="cell">
    <h4>Criteria
      <inline-help help-key="criterion"></inline-help>
    </h4>
  </div>
  <div class="cell large-10">
    <table class="full-width">
      <thead>
        <tr>
          <th>Title</th>
          <th>Unit
            <inline-help help-key="criterion-unit"></inline-help>
          </th>
          <th>Description</th>
          <th>Reference
            <inline-help help-key="criterion-source"></inline-help>
          </th>
          <th ng-if="isStandAlone">Strength of evidence / Uncertainties</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="row in rows">
          <td ng-if="row.isHeaderRow" colspan="6">
            <div class="main-header">
              {{row.headerText}}
            </div>
          </td>
          <td ng-if="!row.isHeaderRow && row.isFirstRow" rowspan="{{row.criterion.numberOfDataSources}}">
            <div class="grid-x">
              <div class="cell small-2" ng-if="editMode.isUserOwner">
                <div style="line-height: 10px; margin-bottom: 4px;">
                  <a ng-click="criterionUp(getIndex(criteria, row.criterion.id))" class="nav-arrow" ng-if="getIndex(criteria, row.criterion.id) !== 0 && getIndex(criteria, row.criterion.id) !== problem.valueTree.children[0].criteria.length">
                    <i style="line-height:0px;" class="fa fa-caret-up"></i>
                  </a>
                  <i ng-if="getIndex(criteria, row.criterion.id) === 0 || getIndex(criteria, row.criterion.id) === problem.valueTree.children[0].criteria.length"
                    style="line-height:0px; color:#bbb" class="fa fa-caret-up"></i>
                </div>
                <div style="line-height: 10px;">
                  <a ng-click="criterionDown(getIndex(criteria, row.criterion.id))" class="nav-arrow" ng-if="getIndex(criteria, row.criterion.id) !== criteria.length-1 && getIndex(criteria, row.criterion.id) !== problem.valueTree.children[0].criteria.length-1">
                    <i style="line-height:0px;" class="fa fa-caret-down"></i>
                  </a>
                  <i ng-if="getIndex(criteria, row.criterion.id) === criteria.length-1 || getIndex(criteria, row.criterion.id) === problem.valueTree.children[0].criteria.length-1"
                    style="line-height:0px; color:#bbb" class="fa fa-caret-down"></i>
                </div>
              </div>
              <div class="cell small-10">
                <a ng-if="editMode.isUserOwner && isStandAlone" ng-click="editCriterion(problem.criteria[row.criterion.id], row.criterion.id)">
                  <i class="fa fa-edit"></i>
                </a> {{row.criterion.title}}
              </div>
            </div>
          </td>
          <td ng-if="!row.isHeaderRow && row.isFirstRow" rowspan="{{row.criterion.numberOfDataSources}}">{{row.criterion.unitOfMeasurement}}</td>
          <td ng-if="!row.isHeaderRow && row.isFirstRow" rowspan="{{row.criterion.numberOfDataSources}}">{{row.criterion.description}}</td>
          <td ng-if="!row.isHeaderRow">
            <a ng-if="row.dataSource.sourceLink" href="{{row.dataSource.sourceLink}}">{{row.dataSource.source}}</a>
            <span ng-if="!row.dataSource.sourceLink">{{row.dataSource.source}}</span>
          </td>
          <td ng-if="!row.isHeaderRow && isStandAlone">
            <div ng-if="row.dataSource.strengthOfEvidence">
              <b>SoE: </b>{{row.dataSource.strengthOfEvidence}}</div>
            <div ng-if="row.dataSource.uncertainties">
              <b>Unc: </b> {{row.dataSource.uncertainties}}</div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="cell">
    <h4>Alternatives
      <inline-help help-key="alternative"></inline-help>
    </h4>
  </div>
  <div class="cell large-6">
    <table width="100%">
      <thead>
        <tr>
          <th>Alternative title</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="alternative in alternatives">
          <td>
            <div class="grid-x">
              <div ng-if="editMode.isUserOwner" class="cell small-1">
                <div style="line-height: 10px; margin-bottom: 4px;">
                  <a ng-click="alternativeUp($index)" class="nav-arrow" ng-if="$index !== 0">
                    <i style="line-height:0px;" class="fa fa-caret-up"></i>
                  </a>
                  <i ng-if="$index === 0" style="line-height:0px; color:#bbb" class="fa fa-caret-up"></i>
                </div>
                <div style="line-height: 10px;">
                  <a ng-click="alternativeDown($index)" class="nav-arrow" ng-if="$index !== alternatives.length-1">
                    <i style="line-height:0px;" class="fa fa-caret-down"></i>
                  </a>
                  <i ng-if="$index === alternatives.length-1" style="line-height:0px; color:#bbb" class="fa fa-caret-down"></i>
                </div>
              </div>
              <div class="cell small-11">
                <a ng-if="editMode.isUserOwner && isStandAlone" ng-click="editAlternative(alternative)">
                  <i class="fa fa-edit"></i>
                </a>{{alternative.title}}
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="cell underlined-div"></div>
  <div class="cell">
    <effects-table criteria="criteria" alternatives="alternatives" value-tree="problem.valueTree" edit-mode="editMode" effects-table-info="effectsTableInfo"
      scales="scales"></effects-table>
  </div>
</div>
